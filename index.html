<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HiChord Test Procedure</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>HiChord™ Test Procedure</h1>
            <p class="subtitle">Production Quality Assurance Protocol</p>
        </header>

        <!-- Test Mode Selector -->
        <div class="test-mode-selector">
            <button class="test-mode-btn active" id="manualTestBtn">
                <span class="mode-label">Manual Tests</span>
                <span class="mode-description">Step-by-step testing procedure</span>
            </button>
            <button class="test-mode-btn" id="autoTestBtn">
                <span class="mode-label">Automated Hardware Test</span>
                <span class="mode-description">USB-connected button verification</span>
            </button>
        </div>

        <!-- Manual Mode Container -->
        <div id="manualMode" class="test-mode active">

            <!-- Test Overview Navigation -->
            <nav class="test-overview" id="testOverview">
                <!-- Will be populated dynamically -->
            </nav>

            <nav class="test-nav">
                <button class="nav-btn" id="prevBtn" disabled>← Previous</button>
                <span class="test-progress" id="testProgress">Test 1 of 12</span>
                <button class="nav-btn" id="nextBtn">Next →</button>
            </nav>

            <!-- Test Steps Container -->
            <div class="test-steps-container" id="manualSteps">
                <!-- Tests will be dynamically loaded here -->
            </div>

            <nav class="test-nav bottom">
                <button class="nav-btn" id="prevBtnBottom" disabled>← Previous</button>
                <button class="nav-btn" id="nextBtnBottom">Next →</button>
            </nav>
        </div>

        <!-- Automated Hardware Test Mode -->
        <div id="automatedMode" class="test-mode" style="display: none;">
            <!-- Connection Panel -->
            <div class="connection-panel">
                <div class="connection-status" id="connectionStatus">
                    <div class="status-indicator disconnected" id="statusIndicator"></div>
                    <div class="status-text">
                        <div id="statusTitle">Not Connected</div>
                        <div id="statusSubtitle">Connect HiChord™ via USB-C</div>
                    </div>
                </div>
                <button class="btn-connect" id="connectBtn">Connect to HiChord</button>
            </div>

            <!-- Hardware Info -->
            <div class="hardware-info" id="hardwareInfo" style="display: none;">
                <h3>Detected Hardware</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Firmware:</span>
                        <span class="info-value" id="detectedFirmware">—</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">PCB Batch:</span>
                        <span class="info-value" id="detectedBatch">—</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Button System:</span>
                        <span class="info-value" id="detectedButtonSystem">—</span>
                    </div>
                </div>
            </div>

            <!-- Test Controls -->
            <div class="test-controls" id="testControls" style="display: none;">
                <button class="btn-start-test" id="startTestBtn">START TEST</button>
                <div class="test-quick-stats">
                    <div class="quick-stat-item">
                        <div class="stat-number">21</div>
                        <div class="stat-label">Total Tests</div>
                    </div>
                    <div class="quick-stat-item">
                        <div class="stat-number">~2</div>
                        <div class="stat-label">Minutes</div>
                    </div>
                </div>
                <div class="test-coverage-note">
                    <h4>What This Test Covers:</h4>
                    <ul>
                        <li><strong>✓ All Buttons:</strong> 7 chord buttons + 3 menu buttons</li>
                        <li><strong>✓ Joystick:</strong> 8 directions + click detection</li>
                        <li><strong>✓ Volume Wheel:</strong> Left and right rotation</li>
                    </ul>
                    <p style="margin-top: 12px; font-size: 13px; color: var(--black); font-weight: 600;">
                        <strong>⚠️ IMPORTANT:</strong> Follow the HiChord OLED screen during the test.
                        The device will guide you through each step.
                        This web page only shows final results.
                    </p>
                </div>
            </div>

            <!-- Current Test Display -->
            <div class="current-test-card" id="currentTest" style="display: none;">
                <div class="test-progress-bar-slim">
                    <div class="progress-fill-slim" id="progressFill"></div>
                </div>
                <div class="progress-count" id="progressText">0 / 0</div>

                <div class="test-instruction-large" id="currentTestInstruction">Please follow the instructions below</div>

                <div class="test-visual-display" id="testDisplay">
                    <!-- Dynamic test content -->
                </div>

                <div class="test-status-indicator" id="testStatus">
                    <div class="status-icon" id="statusIcon">⏳</div>
                    <div class="status-text" id="statusText">Testing...</div>
                </div>
            </div>

            <!-- Test Results Summary -->
            <div class="test-results-card" id="testResults" style="display: none;">
                <div class="results-verdict" id="resultsVerdict">
                    <div class="verdict-icon" id="verdictIcon">✓</div>
                    <div class="verdict-text" id="verdictText">ALL TESTS PASSED</div>
                </div>

                <div class="results-stats-grid">
                    <div class="stat-box stat-pass">
                        <div class="stat-big-number" id="passedCount">0</div>
                        <div class="stat-small-label">PASSED</div>
                    </div>
                    <div class="stat-box stat-fail">
                        <div class="stat-big-number" id="failedCount">0</div>
                        <div class="stat-small-label">FAILED</div>
                    </div>
                    <div class="stat-box stat-total">
                        <div class="stat-big-number" id="totalCount">0</div>
                        <div class="stat-small-label">TOTAL</div>
                    </div>
                </div>

                <div class="results-actions-row">
                    <button class="btn-action-secondary" onclick="printAutoResults()">PRINT</button>
                    <button class="btn-action-primary" onclick="resetAutoTests()">TEST AGAIN</button>
                </div>

                <details class="results-detail-section">
                    <summary>View Detailed Results</summary>
                    <div class="results-detail-list" id="resultsDetail">
                        <!-- Detailed results will be added here -->
                    </div>
                </details>
            </div>

            <!-- Console Log -->
            <div class="console-log">
                <h4>Diagnostic Log</h4>
                <div class="log-output" id="logOutput">
                    <div class="log-item info">System ready. Connect HiChord to begin.</div>
                </div>
                <button class="btn-secondary btn-small" onclick="clearLog()">Clear Log</button>
            </div>
        </div>

        <!-- Summary Section -->
        <div class="summary-section" id="summarySection" style="display: none;">
            <h2>Test Summary</h2>
            <div class="summary-grid">
                <div class="summary-item">
                    <div class="summary-label">Passed</div>
                    <div class="summary-value" id="passCount">0</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Failed</div>
                    <div class="summary-value fail" id="failCount">0</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Skipped</div>
                    <div class="summary-value skip" id="skipCount">0</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Total</div>
                    <div class="summary-value" id="totalCount">12</div>
                </div>
            </div>
            <div class="summary-actions">
                <button class="btn-primary" onclick="printReport()">Print Report</button>
                <button class="btn-secondary" onclick="resetTests()">Reset All Tests</button>
                <button class="btn-secondary" onclick="goBackToTests()">Back to Tests</button>
            </div>
        </div>

        <footer>
            <p>HiChord™ Test Procedure v3.0 | Manual Testing + USB/MIDI Connection Tests</p>
        </footer>
    </div>

    <script src="manual-tests.js"></script>
    <script src="midi-test.js"></script>
    <script src="app.js"></script>
    <script src="automated-hardware-test.js"></script>
</body>
</html>
